	\Statex \Comment{основной цикл}
	
	\State $t=1$;
	\While{$t\leqslant{h^j}-1$} \label{alst:cycle_start}
		\State $\bar x^j:=\omega(t)$;
	
		\ForAll{каузальных матриц $z$ из множества $Z^*$}
			\If{$\frac{\|e_t-\bar x^j(t)\|}{\|e_t\|+\|\bar x^j\|}\geqslant{c_2}$} \label{alst:update_z}
				\State $Z^*=Z^*\setminus\{z\}$;
			\EndIf
		\EndFor
	
		\State $Z^*$ - текущее состояние; 
		
		\State $\bar N=(|\{z|z\in Z^*,z\in Z^p(s_1)\}|,\dots,|\{z|z\in Z^*,z\in Z^p(s_l)\}|)$; \label{alst:calc_out1}
		\State $\eta(t):=\tilde x^j=W(\bar N)$; \label{alst:calc_out3}
	
		\State $t=t+1$;
		\If{$t\leqslant h^j-2$}
			\State $\varphi^j(t):=\hat x^j=W(\sum_{s_k\in F^*}\hat x_k^{j+1}\sum_{z\in Z^*}\bar e_t(z))$; \label{alst:calc_state1}
		\EndIf
	\EndWhile \label{alst:cycle_end}
	
	\Return $\varphi^j,\vec\eta^j$.